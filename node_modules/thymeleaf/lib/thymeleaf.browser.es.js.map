{"version":3,"file":"thymeleaf.browser.es.js","sources":["../source/standard/expressions/AllInput.js","../source/parser/Grammar.js","../source/parser/Operators.js","../source/parser/InputBuffer.js","../source/parser/RegularExpression.js","../source/parser/Rule.js","../source/standard/expressions/ThymeleafExpressionLanguage.js","../source/parser/Parser.js","../source/standard/expressions/ExpressionProcessor.js","../source/processors/AttributeProcessor.js","../source/standard/processors/AttrAttributeProcessor.js","../source/standard/processors/CheckedAttributeProcessor.js","../source/standard/processors/ClassAppendAttributeProcessor.js","../source/standard/processors/EachAttributeProcessor.js","../source/standard/processors/EmptyableAttributeProcessor.js","../source/standard/processors/FragmentAttributeProcessor.js","../source/utilities/Dom.js","../source/standard/processors/IfAttributeProcessor.js","../node_modules/regenerator-runtime/runtime.js","../node_modules/regenerator-runtime/runtime-module.js","../node_modules/babel-runtime/regenerator/index.js","../source/standard/processors/InsertAttributeProcessor.js","../source/standard/processors/RemovableAttributeProcessor.js","../source/standard/processors/TextAttributeProcessor.js","../source/standard/processors/UTextAttributeProcessor.js","../source/dialects/Dialect.js","../source/standard/StandardDialect.js","../source/Configurations.js","../source/processors/Matcher.js","../source/utilities/Functions.js","../source/TemplateEngine.js","../source/Thymeleaf.js"],"sourcesContent":["/* \n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * A special kind of expression that requires the referenced rule consume all\n * available input.\n * \n * @param {String} ruleName\n * @return {Matchable}\n */\nexport const AllInput = ruleName => (input, parser) => {\n\tlet matchResult = parser.parseWithExpression(input, ruleName);\n\treturn matchResult !== null && input.exhausted() ? matchResult : null;\n};\n","/* \n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * A collection of Rules that describes a language.\n * \n * @author Emanuel Rabina\n */\nexport default class Grammar {\n\n\t/**\n\t * @param {String} name\n\t * @param {Rule} startingRule\n\t * @param {...Rule} additionalRules\n\t */\n\tconstructor(name, startingRule, ...additionalRules) {\n\n\t\tthis.name = name;\n\t\tthis.rules = [].concat(startingRule, additionalRules);\n\t}\n\n\t/**\n\t * Given an input string and a parser, return whether or not the input is\n\t * accepted by this grammar.\n\t * \n\t * @param {InputBuffer} input\n\t * @param {Parser} parser\n\t * @return {Object} If the input is accepted, this will be the non-null result\n\t *   of matching against the rules of this grammar.\n\t */\n\taccept(input, parser) {\n\n\t\treturn this.startingRule.accept(input, parser);\n\t}\n\n\t/**\n\t * Return the rule that has the given name.\n\t * \n\t * @param {String} name\n\t * @return {Rule}\n\t */\n\tfindRuleByName(name) {\n\n\t\tlet rule = this.rules.find(rule => rule.name === name);\n\t\tif (!rule) {\n\t\t\tthrow new Error(`Failed to find a rule named \"${name}\" in the grammar`);\n\t\t}\n\t\treturn rule;\n\t}\n\n\t/**\n\t * Returns the grammar's starting rule.\n\t * \n\t * @return {Rule}\n\t */\n\tget startingRule() {\n\n\t\treturn this.rules[0];\n\t}\n}\n","/* \n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns an expression function where the underlying expression doesn't need\n * to be matched.  Thus, optional expressions \"always\" match.\n * \n * @param {Matchable} expression\n * @return {Matchable}\n */\nexport const Optional = expression => (input, parser) => {\n\treturn input.markAndClearOrReset(() => {\n\t\tlet result = parser.parseWithExpression(input, expression);\n\t\treturn result !== null ? result : '';\n\t});\n};\n\n/**\n * Returns an expression function where the expression must be matched against\n * at least once to be considered a match.\n * \n * @param {Matchable} expression\n * @return {Matchable}\n */\nexport const OneOrMore = (expression) => (input, parser) => {\n\treturn input.markAndClearOrReset(() => {\n\t\tlet results = [];\n\t\twhile (true) {\n\t\t\tlet result = input.markAndClearOrReset(() => {\n\t\t\t\treturn parser.parseWithExpression(input, expression);\n\t\t\t});\n\t\t\tif (result) {\n\t\t\t\tresults.push(result);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn results.length > 0 ? results : null;\n\t});\n};\n\n/**\n * Returns an expression function where only one of the underlying expressions\n * must be matched in order to consider the expression a match.\n * \n * @param {...Matchable} expressions\n * @return {Matchable}\n */\nexport const OrderedChoice = (...expressions) => (input, parser) => {\n\treturn input.markAndClearOrReset(() => {\n\t\tfor (let expression of expressions) {\n\t\t\tlet result = input.markAndClearOrReset(() => {\n\t\t\t\treturn parser.parseWithExpression(input, expression);\n\t\t\t});\n\t\t\tif (result !== null) {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t});\n};\n\n/**\n * Returns an expression whose underlying expressions must be matched in order\n * to consider the entire expression a match.\n * \n * @param {...Matchable} expressions\n * @return {Matchable}\n */\nexport const Sequence = (...expressions) => (input, parser) => {\n\treturn input.markAndClearOrReset(() => {\n\t\tlet results = [];\n\t\tfor (let expression of expressions) {\n\t\t\tlet result = input.markAndClearOrReset(() => {\n\t\t\t\treturn parser.parseWithExpression(input, expression);\n\t\t\t});\n\t\t\tif (result === null) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tresults.push(result);\n\t\t}\n\t\treturn results;\n\t});\n};\n","/* \n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Wrapper around the string being parsed, with a position that keeps track of\n * what part of the imput is currently being read/tested.\n * \n * @author Emanuel Rabina\n */\nexport default class InputBuffer {\n\n\t/**\n\t * @private\n\t * @type {Number}\n\t */\n\tposition = 0;\n\n\t/**\n\t * @private\n\t * @type {Array<Number>}\n\t */\n\tpositionStack = [];\n\n\t/**\n\t * @param {String} input\n\t */\n\tconstructor(input) {\n\n\t\tthis.input = input;\n\t}\n\n\t/**\n\t * Clear the previously {@link #mark}ed position.\n\t */\n\tclear() {\n\n\t\tlet lastPosition = this.positionStack.pop();\n\t\tif (lastPosition === undefined) {\n\t\t\tthrow new Error('Called clear() but no matching mark()');\n\t\t}\n\t}\n\n\t/**\n\t * Returns whether or not the current position is at the end of the input,\n\t * meaning we've exhausted the entire input string.\n\t * \n\t * @return {Boolean}\n\t */\n\texhausted() {\n\n\t\treturn this.position === this.input.length;\n\t}\n\n\t/**\n\t * Sets a mark at the current position so that it can be returned to by a\n\t * matching {@link #reset} call.\n\t */\n\tmark() {\n\n\t\tthis.positionStack.push(this.position);\n\t}\n\n\t/**\n\t * Convenience method for surrounding a function with a call to {@link #mark},\n\t * then {@link #clear} if the result of the function is non-null, or\n\t * {@link #reset} if `null`.\n\t * \n\t * @template T\n\t * @param {Function<T>} func\n\t * @return {T}\n\t */\n\tmarkAndClearOrReset(func) {\n\n\t\tthis.mark();\n\t\tlet result = func();\n\t\tif (result !== null) {\n\t\t\tthis.clear();\n\t\t\treturn result;\n\t\t}\n\t\tthis.reset();\n\t\treturn null;\n\t}\n\n\t/**\n\t * Reads as many characters from the current position as satisfies the given\n\t * pattern, returning the read characters and advancing the mark by as many\n\t * characters.\n\t * \n\t * @param {RegExp} pattern\n\t * @return {Array} The array of matched strings, or `null` if the pattern\n\t *   didn't match.\n\t */\n\tread(pattern) {\n\n\t\tlet remaining = this.input.substring(this.position);\n\t\tlet leadingWhitespace = remaining.match(/^\\s+/);\n\t\tif (leadingWhitespace) {\n\t\t\tleadingWhitespace = leadingWhitespace[0];\n\t\t\tremaining = remaining.substring(leadingWhitespace.length);\n\t\t}\n\t\tlet result = new RegExp(pattern.source).exec(remaining);\n\t\tif (result) {\n\t\t\tlet [value] = result;\n\t\t\tif (remaining.startsWith(value)) {\n\t\t\t\tthis.position += (value.length + (leadingWhitespace ? leadingWhitespace.length : 0));\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Revert to the last @{link #mark}ed position.\n\t */\n\treset() {\n\n\t\tlet newPosition = this.positionStack.pop();\n\t\tif (newPosition === undefined) {\n\t\t\tthrow new Error('Called reset() but no matching mark()');\n\t\t}\n\t\tthis.position = newPosition;\n\t}\n}\n","/* \n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport InputBuffer from './InputBuffer';\n\n/**\n * A special kind of expression that understands matched portions of regular\n * expressions to run processing over, which may lead to additional parsing\n * expressions.\n * \n * This expression should be used sparingly as the regexes within need to take\n * care of whitespace between tokens themselves, which can be annoying.\n * \n * @param {RegExp} expression\n * @param {Array<Matchable>} matchers\n * @return {Matchable}\n */\nexport const RegularExpression = (expression, matchers) => (input, parser) => {\n\treturn input.markAndClearOrReset(() => {\n\t\tlet result = input.read(expression);\n\t\tif (result) {\n\t\t\tlet parseResults = [result[0]];\n\t\t\tfor (let i = 1; i < result.length; i++) {\n\t\t\t\tlet match = result[i];\n\t\t\t\tif (match !== undefined) {\n\t\t\t\t\tlet parseResult = parser.parseWithExpression(new InputBuffer(match), matchers[i - 1]);\n\t\t\t\t\tif (parseResult === null) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\tparseResults.push(parseResult);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn parseResults;\n\t\t}\n\t\treturn null;\n\t});\n};\n","/*\n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Default processor which returns the result as is.\n * \n * @template T\n * @param {T} result\n * @return {T}\n */\nfunction defaultMatchProcessor(result) {\n\treturn result;\n}\n\n/**\n * A rule describes a string in the language.\n * \n * @author Emanuel Rabina\n */\nexport default class Rule {\n\n\t/**\n\t * @param {String} name\n\t * @param {Object} expression\n\t * @param {Function} [matchProcessor=defaultExpressionAction]\n\t */\n\tconstructor(name, expression, matchProcessor = defaultMatchProcessor) {\n\n\t\tthis.name           = name;\n\t\tthis.expression     = expression;\n\t\tthis.matchProcessor = matchProcessor;\n\t}\n\n\t/**\n\t * Given an input string and a parser, return whether or not the input is\n\t * accepted by this rule.\n\t * \n\t * @param {InputBuffer} input\n\t * @param {Parser} parser\n\t * @return {Object} If the input is accepted, this will be the non-null result\n\t *   of matching against the rule.\n\t */\n\taccept(input, parser) {\n\n\t\tlet matchResult = parser.parseWithExpression(input, this.expression);\n\t\treturn matchResult !== null ? this.matchProcessor(matchResult) : null;\n\t}\n}\n","/* \n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AllInput}          from './AllInput';\nimport ExpressionProcessor from './ExpressionProcessor';\nimport Grammar             from '../../parser/Grammar';\nimport {Optional,\n\tOneOrMore,\n\tOrderedChoice,\n\tSequence}                from '../../parser/Operators';\nimport {RegularExpression} from '../../parser/RegularExpression';\nimport Rule                from '../../parser/Rule';\n\nimport {remove}   from '@ultraq/array-utils';\nimport {navigate} from '@ultraq/object-utils';\n\n/**\n * Grammar for the Thymeleaf expression language.  Describes the language and\n * how to parse it.\n * \n * @author Emanuel Rabina\n */\nexport default new Grammar('Thymeleaf Expression Language',\n\n\t// Ordered as at https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#standard-expression-syntax\n\tnew Rule('ThymeleafExpression',\n\t\tOrderedChoice(\n\t\t\tAllInput('VariableExpression'),\n\t\t\tAllInput('LinkExpression'),\n\t\t\tAllInput('FragmentExpression'),\n\t\t\tAllInput('Iteration'),\n\t\t\tAllInput('StringConcatenation'),\n\t\t\tAllInput('Literal'),\n\t\t\tAllInput('LogicalExpression'),\n\t\t\tAllInput('IfThenCondition'),\n\t\t\tAllInput('IfThenElseCondition'),\n\t\t\tAllInput('Nothing')\n\t\t)\n\t),\n\n\n\t// Simple expressions\n\t// ==================\n\n\t/**\n\t * Variable expressions, `${variable}`.  Represents a value to be retrieved\n\t * from the current context.\n\t */\n\tnew Rule('VariableExpression',\n\t\tSequence(/\\${/, 'Identifier', /\\}/),\n\t\t([, identifier]) => context => {\n\t\t\tlet result = navigate(context, identifier);\n\t\t\treturn result !== null && result !== undefined ? result : '';\n\t\t}\n\t),\n\n\t/**\n\t * Link expressions, `@{url(parameters)}`.  Used for generating URLs out of\n\t * context parameters.\n\t */\n\tnew Rule('LinkExpression',\n\t\tRegularExpression(/^@\\{(.+?)(\\(.+\\))?\\}$/, ['Url', 'UrlParameters']),\n\t\t([, url, parameters]) => context => {\n\n\t\t\tif (parameters) {\n\n\t\t\t\t// TODO: Push this parsing of the parameters list back into the grammar\n\t\t\t\tlet expressionProcessor = new ExpressionProcessor(context);\n\t\t\t\tlet paramsList = parameters.slice(1, -1).split(',').map(param => {\n\t\t\t\t\tlet [lhs, rhs] = param.split('=');\n\t\t\t\t\treturn [lhs, expressionProcessor.process(rhs)];\n\t\t\t\t});\n\n\t\t\t\t// Fill out any placeholders in the URL from the parameters\n\t\t\t\twhile (true) { // eslint-disable-line\n\t\t\t\t\tlet urlTemplate = /(.*?)\\{(.+?)\\}(.*)/.exec(url);\n\t\t\t\t\tif (urlTemplate) {\n\t\t\t\t\t\tlet [, head, placeholder, tail] = urlTemplate;\n\t\t\t\t\t\tlet paramEntry = remove(paramsList, ([lhs]) => lhs === placeholder);\n\t\t\t\t\t\tif (paramEntry) {\n\t\t\t\t\t\t\turl = `${head}${paramEntry[1]}${tail}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Remaining parameters become search query parameters\n\t\t\t\tif (paramsList.length) {\n\t\t\t\t\turl += `?${paramsList.map(([key, value]) => `${key}=${value}`).join('&')}`;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn url;\n\t\t}\n\t),\n\tnew Rule('Url', /.+/),\n\tnew Rule('UrlParameters', /\\((.+)\\)/),\n\n\t/**\n\t * Fragment expressions, `~{template :: fragment(parameters)}`.  A locator for\n\t * a piece of HTML in the same or another template.\n\t */\n\tnew Rule('FragmentExpression',\n\t\tSequence(/~{/, 'TemplateName', /::/, 'FragmentName', 'FragmentParameters', /}/),\n\t\t([, templateName, , fragmentName, parameters]) => () => {\n\n\t\t\t// TODO: Should executing a fragment expression locate and return the\n\t\t\t//       fragment?  If so, then it'll make expression execution\n\t\t\t//       asynchronous!\n\t\t\treturn {\n\t\t\t\ttemplateName,\n\t\t\t\tfragmentName,\n\t\t\t\tparameters\n\t\t\t};\n\t\t}\n\t),\n\tnew Rule('TemplateName', /[\\w-._]+/),\n\tnew Rule('FragmentName', /[\\w-._]+/),\n\n\t// TODO: We're not doing anything with these yet\n\tnew Rule('FragmentParameters',\n\t\tOptional(/\\(.+\\)/)\n\t),\n\n\n\t// Complex expressions\n\t// ===================\n\n\t/**\n\t * Iteration, `localVar : ${collection}`.  The name of the variable for each\n\t * loop, followed by the collection being iterated over.\n\t */\n\tnew Rule('Iteration',\n\t\tSequence('Identifier', Optional(Sequence(/,/, 'Identifier')), /:/, 'VariableExpression'),\n\t\t([localValueName, [, iterationStatusVariable], , collectionExpressionAction]) => context => ({\n\t\t\tlocalValueName,\n\t\t\titerable: collectionExpressionAction(context),\n\t\t\titerationStatusVariable\n\t\t})\n\t),\n\n\t/**\n\t * String concatenation, `'...' + '...'` or even `${...} + ${...}`, the\n\t * joining of 2 expressions by way of the `+` operator.\n\t */\n\tnew Rule('StringConcatenation',\n\t\tSequence('Concatenatable', OneOrMore(Sequence(/\\+/, 'Concatenatable'))),\n\t\t([first, [...rest]]) => context => {\n\t\t\tconst coerce = value => typeof value === 'function' ? value(context) : value.toString();\n\t\t\treturn coerce(first) + rest.reduce((result, [, item]) => result + coerce(item), '');\n\t\t}\n\t),\n\tnew Rule('Concatenatable',\n\t\tOrderedChoice(\n\t\t\t'StringLiteral',\n\t\t\t'VariableExpression'\n\t\t)\n\t),\n\n\n\t// Literals\n\t// ========\n\n\tnew Rule('Literal',\n\t\tOrderedChoice(\n\t\t\t'StringLiteral',\n\t\t\t'NumberLiteral',\n\t\t\t'BooleanLiteral',\n\t\t\t'NullLiteral',\n\t\t\t'TokenLiteral'\n\t\t)\n\t),\n\n\t/**\n\t * String literal, characters surrounded by `'` (single quotes).\n\t */\n\tnew Rule('StringLiteral', /'.*?'/, result => () => result.slice(1, -1)),\n\n\t/**\n\t * A number.\n\t */\n\tnew Rule('NumberLiteral', /\\d+(\\.\\d+)?/, result => () => parseFloat(result)),\n\n\t/**\n\t * One of `true` or `false`.\n\t */\n\tnew Rule('BooleanLiteral', /(true|false)/, result => () => result === 'true'),\n\n\t/**\n\t * The word `null` to represent the null value.\n\t */\n\t// TODO: The parser uses null to mean 'failed parse', so this might not work?\n\tnew Rule('NullLiteral', /null/, () => () => null),\n\n\t/**\n\t * A token literal, which is pretty much anything else that can't be categorized\n\t * by the other literal types.  This is often used as a fallback in the\n\t * expression language so that, for any unknown input, we're still returning\n\t * something.\n\t */\n\t// TODO: Is this the same as an Identifier?\n\tnew Rule('TokenLiteral', /[^: ${}]+/, result => () => result),\n\n\n\t// Text operations\n\t// ===============\n\n\n\t// Arithmetic operations\n\t// =====================\n\n\n\t// Boolean operations\n\t// ==================\n\n\n\t// Comparisons and equality\n\t// ========================\n\n\t/**\n\t * A logical expression is any expression that resolves in a `true`/`false`\n\t * value.\n\t */\n\tnew Rule('LogicalExpression',\n\t\tSequence('Operand', 'Comparator', 'Operand'),\n\t\t([leftOperand, comparator, rightOperand]) => context => {\n\t\t\tlet lhs = leftOperand(context);\n\t\t\tlet rhs = rightOperand(context);\n\t\t\tswitch (comparator) {\n\t\t\t\tcase '==':  return lhs == rhs;\n\t\t\t\tcase '===': return lhs === rhs;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t),\n\n\tnew Rule('Comparator',\n\t\tOrderedChoice(\n\t\t\t/===?/\n\t\t)\n\t),\n\n\n\t// Conditional operators\n\t// =====================\n\n\t/**\n\t * If-then condition, `if ? then`.  This is the truthy branch only of the\n\t * classic ternary operator.  The falsey branch is a no-op.\n\t */\n\tnew Rule('IfThenCondition',\n\t\tSequence('Condition', /\\?/, 'Operand'),\n\t\t([condition, , truthyExpression]) => context => {\n\t\t\treturn condition(context) ? truthyExpression(context) : undefined;\n\t\t}\n\t),\n\n\t/**\n\t * If-then-else condition, `if ? then : else`, the classic ternary operator.\n\t */\n\tnew Rule('IfThenElseCondition',\n\t\tSequence('Condition', /\\?/, 'Operand', /:/, 'Operand'),\n\t\t([condition, , truthyExpression, , falseyExpression]) => context => {\n\t\t\treturn condition(context) ? truthyExpression(context) : falseyExpression(context);\n\t\t}\n\t),\n\n\t/**\n\t * A condition is some expression or value that resolves to a true/false\n\t * value.\n\t */\n\tnew Rule('Condition',\n\t\tOrderedChoice(\n\t\t\t'LogicalExpression',\n\t\t\t'Operand'\n\t\t)\n\t),\n\n\n\t// Special tokens\n\t// ==============\n\n\t/**\n\t * An expression that matches the empty string.\n\t */\n\tnew Rule('Nothing', /^$/),\n\n\n\t// Common language basics\n\t// ======================\n\n\tnew Rule('Identifier', /[a-zA-Z_][\\w.]*/),\n\n\t/**\n\t * An operand is either a variable or a literal.\n\t */\n\tnew Rule('Operand',\n\t\tOrderedChoice(\n\t\t\t'VariableExpression',\n\t\t\t'Literal'\n\t\t)\n\t)\n);\n","/*\n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport InputBuffer from './InputBuffer';\n\n/**\n * Any one of the objects that can be matched:\n *  - an expression function\n *  - a string that references another rule\n *  - a regular expression\n * \n * @typedef {String|RegExp|Function} Matchable\n */\n\n/**\n * A recursive descent parser for any parsing expression grammar defined by the\n * constructs in this module.\n * \n * TODO: Own module?\n * \n * @author Emanuel Rabina\n */\nexport default class Parser {\n\n\t/**\n\t * @param {Grammar} grammar\n\t */\n\tconstructor(grammar) {\n\n\t\tthis.grammar = grammar;\n\t}\n\n\t/**\n\t * Parse a string, attempting to build the parse tree defined by the rules in\n\t * the configured grammar.  Parsing is considered successful when there are no\n\t * more non-terminating symbols in the grammar and all of the input has been\n\t * read.\n\t * \n\t * @param {String} input\n\t * @return {Object} The parse tree if the input could be parsed, `null`\n\t *   otherwise.\n\t */\n\tparse(input) {\n\n\t\tlet inputBuffer = new InputBuffer(input);\n\t\tlet matchResult = this.grammar.accept(inputBuffer, this);\n\t\tif (matchResult === null || !inputBuffer.exhausted()) {\n\t\t\tlet errorMessage = `Failed to parse \"${input}\"`;\n\n\t\t\t// Don't bring down the thread if we can't parse\n\t\t\tif (process.env.NODE_ENV === 'production') {\n\t\t\t\tconsole.error(errorMessage);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthrow new Error(errorMessage);\n\t\t\t}\n\t\t}\n\t\treturn matchResult;\n\t}\n\n\t/**\n\t * Parse the input against the given expression.  An expression can either be\n\t * a reference to another rule in the current grammar, or a regular expression\n\t * that consumes input.\n\t * \n\t * @param {InputBuffer} input\n\t * @param {Matchable} expression\n\t * @return {Object}\n\t */\n\tparseWithExpression(input, expression) {\n\n\t\t// Name of another rule in the grammar\n\t\tif (typeof expression === 'string') {\n\t\t\tlet rule = this.grammar.findRuleByName(expression);\n\t\t\treturn rule ? rule.accept(input, this) : null;\n\t\t}\n\n\t\t// A regular expression that must be matched\n\t\telse if (expression instanceof RegExp) {\n\t\t\tlet result = input.read(expression);\n\t\t\tif (result) {\n\t\t\t\treturn result[0];\n\t\t\t}\n\t\t}\n\n\t\t// An expression function to be executed\n\t\telse if (typeof expression === 'function') {\n\t\t\treturn expression(input, this);\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","/* \n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ThymeleafExpressionLanguage from './ThymeleafExpressionLanguage';\nimport Parser                      from '../../parser/Parser';\n\n/**\n * Parses and executes Thymeleaf expressions.\n * \n * TODO: Create a shared instance of this for a processing context so that it\n *       doesn't need to be recreated over and over.\n * \n * @author Emanuel Rabina\n */\nexport default class ExpressionProcessor {\n\n\t/**\n\t * @param {Object} context\n\t */\n\tconstructor(context = {}) {\n\n\t\tthis.context = context;\n\t}\n\n\t/**\n\t * Parse and execute the given input as a Thymeleaf expression.\n\t * \n\t * @param {String} input\n\t * @return {*}\n\t */\n\tprocess(input) {\n\n\t\t// TODO: Probably don't need to create a new parser every time?\n\t\tlet parser = new Parser(ThymeleafExpressionLanguage);\n\t\tlet expressionAction = parser.parse(input);\n\t\treturn expressionAction ? expressionAction(this.context) : null;\n\t}\n}\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Common class for attribute processors.\n * \n * TODO: Do we even need a class for processors?  So far they all seem to be\n *       functions that execute based on a name match, which for all intents can\n *       be as simple as an object name/function pair!\n * \n * @author Emanuel Rabina\n */\nexport default class AttributeProcessor {\n\n\t/**\n\t * Constructor, sets this processor's prefix and name.\n\t * \n\t * @param {String} prefix\n\t * @param {String} name\n\t */\n\tconstructor(prefix, name) {\n\n\t\tthis.prefix = prefix;\n\t\tthis.name   = name;\n\t}\n}\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ExpressionProcessor from '../expressions/ExpressionProcessor';\nimport AttributeProcessor  from '../../processors/AttributeProcessor';\n\nimport {escapeHtml} from '@ultraq/string-utils';\n\n/**\n * JS equivalent of Thymeleaf's `th:attr` attribute processor, modifies or sets\n * a target attribute to whatever its associated expression evaluates to.\n * \n * @author Emanuel Rabina\n */\nexport default class AttrAttributeProcessor extends AttributeProcessor {\n\n\tstatic NAME = 'attr';\n\n\t/**\n\t * Constructor, set this processor to use the `attr` name and supplied prefix.\n\t * \n\t * @param {String} prefix\n\t */\n\tconstructor(prefix) {\n\n\t\tsuper(prefix, AttrAttributeProcessor.NAME);\n\t}\n\n\t/**\n\t * Processes an element that contains a `th:attr` or `data-th-attr` attribute\n\t * on it, picking out the target attributes and setting them to whatever their\n\t * expressions evaluate to.\n\t * \n\t * @param {Element} element\n\t *   Element being processed.\n\t * @param {String} attribute\n\t *   The attribute that was encountered to invoke this processor.\n\t * @param {String} attributeValue\n\t *   The value given by the attribute.\n\t * @param {Object} context\n\t */\n\tprocess(element, attribute, attributeValue, context) {\n\n\t\t// TODO: This regex, is this some kind of value list that needs to be\n\t\t//       turned into an expression?\n\t\tif (/(.+=.+,)*.+=.+/.test(attributeValue)) {\n\t\t\tattributeValue.split(',').forEach(attribute => {\n\t\t\t\tlet attributeParts = attribute.split('=');\n\t\t\t\telement.setAttribute(attributeParts[0], escapeHtml(new ExpressionProcessor(context).process(attributeParts[1])));\n\t\t\t});\n\t\t}\n\t\t/* istanbul ignore next */\n\t\telse if (process.env.NODE_ENV !== 'test') {\n\t\t\tconsole.warn(`Value to ${attribute}, ${attributeValue}, doesn't seem to contain an attribute assignment expression.  Ignoring.`);\n\t\t}\n\t\telement.removeAttribute(attribute);\n\t}\n}\n","/* \n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ExpressionProcessor from '../expressions/ExpressionProcessor';\nimport AttributeProcessor  from '../../processors/AttributeProcessor';\n\n/**\n * Thymeleaf's `th:checked` attribute processor, sets or removes the `checked`\n * attribute from an element based on the result of the expression within it.\n * \n * TODO: This is one of HTML5s \"boolean attributes\", attributes whose values are\n *       true simply by being present in the element, regardless of the value\n *       inside it.  To act as false, the attribute has to be removed.  Find a\n *       way to generate these from some list of boolean attributes so that I\n *       don't need to write a class for each one!\n * \n * @author Emanuel Rabina\n */\nexport default class CheckedAttributeProcessor extends AttributeProcessor {\n\n\tstatic NAME = 'checked';\n\n\t/**\n\t * Constructor, set this processor to use the `checked` name and supplied\n\t * prefix.\n\t * \n\t * @param {String} prefix\n\t */\n\tconstructor(prefix) {\n\n\t\tsuper(prefix, CheckedAttributeProcessor.NAME);\n\t}\n\n\t/**\n\t * Processes an element that contains a `th:checked` or `data-th-checked`\n\t * attribute on it, either setting or removing a `checked` attribute to the\n\t * current element based on the result of the inner expression.\n\t * \n\t * @param {Element} element\n\t *   Element being processed.\n\t * @param {String} attribute\n\t *   The attribute that was encountered to invoke this processor.\n\t * @param {String} attributeValue\n\t *   The value given by the attribute.\n\t * @param {Object} context\n\t */\n\tprocess(element, attribute, attributeValue, context) {\n\n\t\tlet result = new ExpressionProcessor(context).process(attributeValue);\n\t\tif (result) {\n\t\t\telement.setAttribute('checked', '');\n\t\t}\n\t\telse {\n\t\t\telement.removeAttribute('checked');\n\t\t}\n\n\t\telement.removeAttribute(attribute);\n\t}\n}\n","/* \n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ExpressionProcessor from '../expressions/ExpressionProcessor';\nimport AttributeProcessor  from '../../processors/AttributeProcessor';\n\n/**\n * The `th:classappend` is a special attribute that applies the expression to\n * any existing classes already on an element.\n * \n * @author Emanuel Rabina\n */\nexport default class ClassAppendAttributeProcessor extends AttributeProcessor {\n\n\tstatic NAME = 'classappend';\n\n\t/**\n\t * Constructor, set this processor to use the `attr` name and supplied prefix.\n\t * \n\t * @param {String} prefix\n\t */\n\tconstructor(prefix) {\n\n\t\tsuper(prefix, ClassAppendAttributeProcessor.NAME);\n\t}\n\n\t/**\n\t * Processes an element that contains a `th:classappend` or `data-th-classappend`\n\t * attribute on it, adding the resulting classes to any existing classes on\n\t * the current element.\n\t * \n\t * @param {Element} element\n\t *   Element being processed.\n\t * @param {String} attribute\n\t *   The attribute that was encountered to invoke this processor.\n\t * @param {String} attributeValue\n\t *   The value given by the attribute.\n\t * @param {Object} context\n\t */\n\tprocess(element, attribute, attributeValue, context) {\n\n\t\tlet classes = new ExpressionProcessor(context).process(attributeValue);\n\t\tif (classes) {\n\t\t\telement.className += ` ${classes}`;\n\t\t}\n\t\telement.removeAttribute(attribute);\n\t}\n}\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ExpressionProcessor from '../expressions/ExpressionProcessor';\nimport AttributeProcessor  from '../../processors/AttributeProcessor';\n\n/**\n * JS equivalent of Thymeleaf's `th:each` attribute processor, iterates over an\n * [iterable object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols),\n * executing a piece of template for every iteration.\n * \n * @author Emanuel Rabina\n */\nexport default class EachAttributeProcessor extends AttributeProcessor {\n\n\tstatic NAME = 'each';\n\n\t/**\n\t * Constructor, set this processor to use the `each` name and supplied prefix.\n\t * \n\t * @param {String} prefix\n\t */\n\tconstructor(prefix) {\n\n\t\tsuper(prefix, EachAttributeProcessor.NAME);\n\t}\n\n\t/**\n\t * Processes an element that contains a `th:each`/`data-th-each` attribute,\n\t * repeating the markup for every object in the iterable value.\n\t * \n\t * @param {Element} element\n\t *   Element being processed.\n\t * @param {String} attribute\n\t *   The attribute that was encountered to invoke this processor.\n\t * @param {String} attributeValue\n\t *   The value given by the attribute.\n\t * @param {Object} context\n\t * @return {Boolean} Whether or not the parent element needs to do a second\n\t *   pass as its children have been modified by this processor.\n\t */\n\tprocess(element, attribute, attributeValue, context) {\n\n\t\telement.removeAttribute(attribute);\n\n\t\tlet iterationInfo = new ExpressionProcessor(context).process(attributeValue);\n\t\tif (iterationInfo) {\n\t\t\tlet {localValueName, iterable} = iterationInfo;\n\t\t\tlet templateNode = element.cloneNode(true);\n\n\t\t\tfor (let value of iterable) {\n\t\t\t\tlet localClone = templateNode.cloneNode(true);\n\t\t\t\tlet localVariable = {};\n\t\t\t\tlocalVariable[localValueName] = value;\n\n\t\t\t\t// TODO: Standardize this data attribute somewhere.  Shared const?\n\t\t\t\t// element.dataset not yet implemented in JSDOM (https://github.com/tmpvar/jsdom/issues/961),\n\t\t\t\t// so until then we're setting data- attributes the old-fashioned way.\n\t\t\t\tlocalClone.setAttribute('data-thymeleaf-local-variables', JSON.stringify(localVariable));\n\n\t\t\t\telement.parentElement.appendChild(localClone);\n\t\t\t}\n\t\t}\n\t\telement.parentElement.removeChild(element);\n\n\t\treturn true;\n\t}\n}\n","/* \n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ExpressionProcessor from '../expressions/ExpressionProcessor';\nimport AttributeProcessor  from '../../processors/AttributeProcessor';\n\n/**\n * Configurable attribute processor that sets or empties an attribute value on\n * an element if the result of its expression is truthy or falsey respectively.\n * \n * @author Emanuel Rabina\n */\nexport default class EmptyableAttributeProcessor extends AttributeProcessor {\n\n\t/**\n\t * Constructor, set the name of the attribute this processor will operate on.\n\t * \n\t * @param {String} prefix\n\t * @param {String} name\n\t */\n\tconstructor(prefix, name) {\n\n\t\tsuper(prefix, name);\n\t}\n\n\t/**\n\t * Processes an element that contains the configured attribute to be worked\n\t * on, setting it if the expression resolves to a truthy value, or removing it\n\t * if it resolves to a falsey value.\n\t * \n\t * @param {Element} element \n\t *   Element being processed.\n\t * @param {String} attribute\n\t *   The attribute that was encountered to invoke this processor.\n\t * @param {String} attributeValue\n\t *   The value given by the attribute.\n\t * @param {Object} context\n\t */\n\tprocess(element, attribute, attributeValue, context) {\n\n\t\tlet value = new ExpressionProcessor(context).process(attributeValue);\n\t\telement.setAttribute(this.name, value ? value.toString() : '');\n\t\telement.removeAttribute(attribute);\n\t}\n}\n\nexport const EMPTYABLE_ATTRIBUTE_NAMES = [\n\t'href',\n\t'src',\n\t'value'\n];\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport AttributeProcessor from '../../processors/AttributeProcessor';\n\n/**\n * JS equivalent of Thymeleaf's `th:fragment` attribute processor, marks an\n * element as a template fragment that can be imported by other processors like\n * `th:insert`.\n * \n * @author Emanuel Rabina\n */\nexport default class FragmentAttributeProcessor extends AttributeProcessor {\n\n\tstatic NAME = 'fragment';\n\n\t/**\n\t * Constructor, set this processor to use the `fragment` name and supplied\n\t * prefix.\n\t * \n\t * @param {String} prefix\n\t */\n\tconstructor(prefix) {\n\n\t\tsuper(prefix, FragmentAttributeProcessor.NAME);\n\t}\n\n\t/**\n\t * Processes an element that contains a `th:fragment` or `data-th-fragment`\n\t * attribute on it.\n\t * \n\t * @param {Element} element\n\t *   Element being processed.\n\t * @param {String} attribute\n\t *   The attribute that was encountered to invoke this processor.\n\t * @param {String} attributeValue\n\t *   The value given by the attribute.\n\t * @param {Object} context\n\t */\n\tprocess(element, attribute, attributeValue, context) {\n\n\t\telement.removeAttribute(attribute);\n\n\t\t// TODO: Some off-context mechanism for encountered fragments?\n\t\tif (!context.fragments) {\n\t\t\tcontext.fragments = [];\n\t\t}\n\t\tcontext.fragments.push({\n\t\t\tname:    attributeValue,\n\t\t\telement: element.cloneNode(true)\n\t\t});\n\t}\n}\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* global ENVIRONMENT */\n\n/**\n * Removes all of an element's child nodes.\n * \n * @param {Element} element\n */\nexport function clearChildren(element) {\n\twhile (element.firstChild) {\n\t\telement.removeChild(element.firstChild);\n\t}\n}\n\n/**\n * Sets a Thymeleaf attribute and value on an existing element.  Used primarily\n * in tests.\n * \n * @param {Element} element\n * @param {String} attribute\n * @param {String} value\n * @return {Element} The same element but with the attribute and value set on it.\n */\nexport function createThymeleafAttributeValue(element, attribute, value) {\n\telement.setAttribute(attribute, value);\n\treturn element;\n}\n\n/**\n * Use either JSDOM or the browser's native DOM parsing to deserialize the HTML\n * string into a document fragment.\n * \n * @param {String} htmlString\n * @return {DocumentFragment}\n */\nexport function deserialize(htmlString) {\n\treturn ENVIRONMENT === 'browser' ?\n\t\t/* istanbul ignore next */\n\t\tdocument.createRange().createContextualFragment(htmlString) :\n\t\trequire('jsdom').jsdom(htmlString, {\n\t\t\tfeatures: {\n\t\t\t\tFetchExternalResources: false,\n\t\t\t\tProcessExternalResources: false\n\t\t\t}\n\t\t});\n}\n\n/**\n * Use either JSDOM or the browser's native DOM serialization to serialize a\n * document fragment into an HTML string.\n * \n * @param {DocumentFragment} documentFragment\n * @return {String}\n */\nexport function serialize(documentFragment) {\n\treturn ENVIRONMENT === 'browser' ?\n\t\t/* istanbul ignore next */\n\t\tnew XMLSerializer().serializeToString(documentFragment) :\n\t\trequire('jsdom').serializeDocument(documentFragment);\n}\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ExpressionProcessor from '../expressions/ExpressionProcessor';\nimport AttributeProcessor  from '../../processors/AttributeProcessor';\nimport {clearChildren}     from '../../utilities/Dom';\n\n/**\n * JS equivalent of Thymeleaf's `th:if` attribute processor, includes or\n * excludes the current element and its children from rendering, depending on\n * the evaluation of the expression in the attribute value.\n * \n * @author Emanuel Rabina\n */\nexport default class IfAttributeProcessor extends AttributeProcessor {\n\n\tstatic NAME = 'if';\n\n\t/**\n\t * Constructor, set this processor to use the `if` name and supplied prefix.\n\t * \n\t * @param {String} prefix\n\t */\n\tconstructor(prefix) {\n\n\t\tsuper(prefix, IfAttributeProcessor.NAME);\n\t}\n\n\t/**\n\t * Processes an element that contains a `th:if` or `data-th-if` attribute\n\t * on it, evaluating the expression for truthy/falsey, rendering/excluding the\n\t * element and its children based on the result.\n\t * \n\t * @param {Element} element \n\t *   Element being processed.\n\t * @param {String} attribute\n\t *   The attribute that was encountered to invoke this processor.\n\t * @param {String} attributeValue\n\t *   The value given by the attribute.\n\t * @param {Object} context\n\t */\n\tprocess(element, attribute, attributeValue, context) {\n\n\t\tlet expressionResult = new ExpressionProcessor(context).process(attributeValue);\n\t\tif (!expressionResult) {\n\t\t\tclearChildren(element);\n\t\t\telement.parentNode.removeChild(element);\n\t\t}\n\t\telement.removeAttribute(attribute);\n\t}\n}\n","/**\n * Copyright (c) 2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * https://raw.github.com/facebook/regenerator/master/LICENSE file. An\n * additional grant of patent rights can be found in the PATENTS file in\n * the same directory.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  runtime.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration. If the Promise is rejected, however, the\n          // result for this iteration will be rejected with the same\n          // reason. Note that rejections of yielded Promises are not\n          // thrown back into the generator function, as is the case\n          // when an awaited Promise is rejected. This difference in\n          // behavior between yield and await is important, because it\n          // allows the consumer to decide what to do with the yielded\n          // rejection (swallow it and continue, manually .throw it back\n          // into the generator, abandon iteration, whatever). With\n          // await, by contrast, there is no opportunity to examine the\n          // rejection reason outside the generator function, so the\n          // only option is to throw it from the await expression, and\n          // let the generator function handle the exception.\n          result.value = unwrapped;\n          resolve(result);\n        }, reject);\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  runtime.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        if (delegate.iterator.return) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // In sloppy mode, unbound `this` refers to the global object, fallback to\n  // Function constructor if we're in global strict mode. That is sadly a form\n  // of indirect eval which violates Content Security Policy.\n  (function() { return this })() || Function(\"return this\")()\n);\n","// This method of obtaining a reference to the global object needs to be\n// kept identical to the way it is obtained in runtime.js\nvar g = (function() { return this })() || Function(\"return this\")();\n\n// Use `getOwnPropertyNames` because not all browsers support calling\n// `hasOwnProperty` on the global `self` object in a worker. See #183.\nvar hadRuntime = g.regeneratorRuntime &&\n  Object.getOwnPropertyNames(g).indexOf(\"regeneratorRuntime\") >= 0;\n\n// Save the old regeneratorRuntime in case it needs to be restored later.\nvar oldRuntime = hadRuntime && g.regeneratorRuntime;\n\n// Force reevalutation of runtime.js.\ng.regeneratorRuntime = undefined;\n\nmodule.exports = require(\"./runtime\");\n\nif (hadRuntime) {\n  // Restore the original runtime.\n  g.regeneratorRuntime = oldRuntime;\n} else {\n  // Remove the global property added by runtime.js.\n  try {\n    delete g.regeneratorRuntime;\n  } catch(e) {\n    g.regeneratorRuntime = undefined;\n  }\n}\n","module.exports = require(\"regenerator-runtime\");\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport FragmentAttributeProcessor from './FragmentAttributeProcessor';\nimport StandardDialect                    from '../StandardDialect';\nimport ExpressionProcessor                from '../expressions/ExpressionProcessor';\nimport AttributeProcessor                 from '../../processors/AttributeProcessor';\nimport {clearChildren, deserialize}       from '../../utilities/Dom';\n\nimport {$} from 'dumb-query-selector';\n\n/**\n * JS equivalent of Thymeleaf's `th:insert` attribute processor, inserts the\n * referenced template fragment as a child of the current element.\n * \n * @author Emanuel Rabina\n */\nexport default class InsertAttributeProcessor extends AttributeProcessor {\n\n\tstatic NAME = 'insert';\n\n\t/**\n\t * Constructor, set this processor to use the `insert` name and supplied prefix.\n\t * \n\t * @param {String} prefix\n\t */\n\tconstructor(prefix) {\n\n\t\tsuper(prefix, InsertAttributeProcessor.NAME);\n\t}\n\n\t/**\n\t * Processes an element that contains a `th:insert`/`data-th-insert` attribute,\n\t * replacing the current element's children with the DOM in the referenced\n\t * fragment.\n\t * \n\t * @param {Element} element\n\t *   Element being processed.\n\t * @param {String} attribute\n\t *   The attribute that was encountered to invoke this processor.\n\t * @param {String} attributeValue\n\t *   The value given by the attribute.\n\t * @param {Object} context\n\t * @return {Promise<Boolean>} Whether or not the parent element needs to do a\n\t *   second pass as its children have been modified by this processor.\n\t */\n\tasync process(element, attribute, attributeValue, context) {\n\n\t\telement.removeAttribute(attribute);\n\t\tclearChildren(element);\n\n\t\tlet {templateResolver} = context;\n\t\tif (templateResolver) {\n\t\t\tlet fragmentInfo = new ExpressionProcessor(context).process(attributeValue);\n\t\t\tif (fragmentInfo) {\n\t\t\t\tlet {templateName, fragmentName} = fragmentInfo;\n\t\t\t\tlet template = deserialize(await templateResolver(templateName));\n\n\t\t\t\tlet standardDialect = context.dialects.find(dialect => dialect.name === StandardDialect.NAME);\n\t\t\t\tlet dialectPrefix = standardDialect.prefix;\n\t\t\t\tlet fragmentProcessorName = FragmentAttributeProcessor.NAME;\n\t\t\t\tlet fragment =\n\t\t\t\t\t$(`[${dialectPrefix}\\\\:${fragmentProcessorName}^=\"${fragmentName}\"]`, template) ||\n\t\t\t\t\t$(`[data-${dialectPrefix}-${fragmentProcessorName}^=\"${fragmentName}\"`, template);\n\n\t\t\t\telement.appendChild(fragment);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tconsole.log(`No template resolver configured, unable to locate fragment via ${attributeValue} processor`);\n\t\t}\n\n\t\treturn false;\n\t}\n}\n","/* \n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ExpressionProcessor from '../expressions/ExpressionProcessor';\nimport AttributeProcessor  from '../../processors/AttributeProcessor';\n\n/**\n * Configurable attribute processor that sets or removes an attribute on an\n * element if the result of its expression is truthy or falsey respectively.\n * \n * @author Emanuel Rabina\n */\nexport default class RemovableAttributeProcessor extends AttributeProcessor {\n\n\t/**\n\t * Constructor, set the name of the attribute this processor will operate on.\n\t * \n\t * @param {String} prefix\n\t * @param {String} name\n\t */\n\tconstructor(prefix, name) {\n\n\t\tsuper(prefix, name);\n\t}\n\n\t/**\n\t * Processes an element that contains the configured attribute to be worked\n\t * on, setting it if the expression resolves to a truthy value, or removing it\n\t * if it resolves to a falsey value.\n\t * \n\t * @param {Element} element \n\t *   Element being processed.\n\t * @param {String} attribute\n\t *   The attribute that was encountered to invoke this processor.\n\t * @param {String} attributeValue\n\t *   The value given by the attribute.\n\t * @param {Object} context\n\t */\n\tprocess(element, attribute, attributeValue, context) {\n\n\t\tlet value = new ExpressionProcessor(context).process(attributeValue);\n\t\tif (value) {\n\t\t\telement.setAttribute(this.name, value.toString());\n\t\t}\n\t\telse {\n\t\t\telement.removeAttribute(this.name);\n\t\t}\n\n\t\telement.removeAttribute(attribute);\n\t}\n}\n\nexport const REMOVABLE_ATTRIBUTE_NAMES = [\n\t'class'\n];\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ExpressionProcessor from '../expressions/ExpressionProcessor';\nimport AttributeProcessor  from '../../processors/AttributeProcessor';\n\n/**\n * JS equivalent of Thymeleaf's `th:text` attribute processor, applies the\n * expression in the attribute value to the text content of the element being\n * processed, escaping any unsafe input.\n * \n * @author Emanuel Rabina\n */\nexport default class TextAttributeProcessor extends AttributeProcessor {\n\n\tstatic NAME = 'text';\n\n\t/**\n\t * Constructor, set this processor to use the `text` name and supplied prefix.\n\t * \n\t * @param {String} prefix\n\t */\n\tconstructor(prefix) {\n\n\t\tsuper(prefix, TextAttributeProcessor.NAME);\n\t}\n\n\t/**\n\t * Processes an element that contains a `th:text` or `data-th-text` attribute\n\t * on it, taking the text expression in the value and applying it to the text\n\t * content of the element.\n\t * \n\t * @param {Element} element \n\t *   Element being processed.\n\t * @param {String} attribute\n\t *   The attribute that was encountered to invoke this processor.\n\t * @param {String} attributeValue\n\t *   The value given by the attribute.\n\t * @param {Object} context\n\t */\n\tprocess(element, attribute, attributeValue, context) {\n\n\t\telement.textContent = new ExpressionProcessor(context).process(attributeValue);\n\t\telement.removeAttribute(attribute);\n\t}\n}\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ExpressionProcessor from '../expressions/ExpressionProcessor';\nimport AttributeProcessor  from '../../processors/AttributeProcessor';\n\n/**\n * JS equivalent of Thymeleaf's `th:utext` attribute processor, applies the\n * expression in the attribute value to the text content of the element being\n * processed.\n * \n * @author Emanuel Rabina\n */\nexport default class UTextAttributeProcessor extends AttributeProcessor {\n\n\tstatic NAME = 'utext';\n\n\t/**\n\t * Constructor, set this processor to use the `utext` name and supplied\n\t * prefix.\n\t * \n\t * @param {String} prefix\n\t */\n\tconstructor(prefix) {\n\n\t\tsuper(prefix, UTextAttributeProcessor.NAME);\n\t}\n\n\t/**\n\t * Processes an element that contains a `th:utext` or `data-th-utext`\n\t * attribute on it, taking the text expression in the value and applying it to\n\t * the text content of the element.\n\t *\n\t * @param {Element} element\n\t *   Element being processed.\n\t * @param {String} attribute\n\t *   The attribute that was encountered to invoke this processor.\n\t * @param {String} attributeValue\n\t *   The value given by the attribute.\n\t * @param {Object} context\n\t */\n\tprocess(element, attribute, attributeValue, context) {\n\n\t\telement.innerHTML = new ExpressionProcessor(context).process(attributeValue);\n\t\telement.removeAttribute(attribute);\n\t}\n}\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Common class for dialects.\n * \n * @author Emanuel Rabina\n */\nexport default class Dialect {\n\n\t/**\n\t * Constructor, sets this dialect's name and prefix.\n\t * \n\t * @param {String} name\n\t * @param {String} prefix\n\t */\n\tconstructor(name, prefix) {\n\n\t\tthis.name   = name;\n\t\tthis.prefix = prefix;\n\t}\n}\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport AttrAttributeProcessor        from './processors/AttrAttributeProcessor';\nimport CheckedAttributeProcessor     from './processors/CheckedAttributeProcessor';\nimport ClassAppendAttributeProcessor from './processors/ClassAppendAttributeProcessor';\nimport EachAttributeProcessor        from './processors/EachAttributeProcessor';\nimport EmptyableAttributeProcessor,\n\t{EMPTYABLE_ATTRIBUTE_NAMES}        from './processors/EmptyableAttributeProcessor';\nimport FragmentAttributeProcessor    from './processors/FragmentAttributeProcessor';\nimport IfAttributeProcessor          from './processors/IfAttributeProcessor';\nimport InsertAttributeProcessor      from './processors/InsertAttributeProcessor';\nimport RemovableAttributeProcessor,\n\t{REMOVABLE_ATTRIBUTE_NAMES}        from './processors/RemovableAttributeProcessor';\nimport TextAttributeProcessor        from './processors/TextAttributeProcessor';\nimport UTextAttributeProcessor       from './processors/UTextAttributeProcessor';\nimport Dialect                       from '../dialects/Dialect';\n\n/**\n * The out-of-the-box dialect for Thymeleaf, the \"Standard Dialect\".\n * \n * @author Emanuel Rabina\n */\nexport default class StandardDialect extends Dialect {\n\n\tstatic NAME           = 'Standard';\n\tstatic DEFAULT_PREFIX = 'thjs';\n\n\t/**\n\t * Create an instance of this dialect with the name \"Standard\" and\n\t * given prefix, defaulting to \"th\" if not supplied.\n\t * \n\t * @param {String} [prefix='thjs']\n\t */\n\tconstructor(prefix = StandardDialect.DEFAULT_PREFIX) {\n\n\t\tsuper(StandardDialect.NAME, prefix);\n\t}\n\n\t/**\n\t * Returns the supported standard processors.\n\t * \n\t * @return {Array} A list of the processors included in this dialect.\n\t */\n\tget processors() {\n\n\t\t// TODO: This is a very basic way of imposing the order of attribute\n\t\t//       processors.  It's currently ordered in the same way as OG\n\t\t//       Thymeleaf.  Figure out a 'proper' way to do the ordering.\n\n\t\t// Order taken from https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#attribute-precedence\n\t\tlet {prefix} = this;\n\t\treturn [].concat(\n\t\t\t// Fragment inclusion\n\t\t\tnew InsertAttributeProcessor(prefix),\n\n\t\t\t// Fragment iteration\n\t\t\tnew EachAttributeProcessor(prefix),\n\n\t\t\t// Conditional evaluation\n\t\t\tnew IfAttributeProcessor(prefix),\n\n\t\t\t// Local variable definition\n\t\t\tnew AttrAttributeProcessor(prefix),\n\t\t\tnew ClassAppendAttributeProcessor(prefix),\n\n\t\t\t// General attribute modification\n\t\t\tEMPTYABLE_ATTRIBUTE_NAMES.map(attributeName => {\n\t\t\t\treturn new EmptyableAttributeProcessor(prefix, attributeName);\n\t\t\t}),\n\t\t\tREMOVABLE_ATTRIBUTE_NAMES.map(attributeName => {\n\t\t\t\treturn new RemovableAttributeProcessor(prefix, attributeName);\n\t\t\t}),\n\n\t\t\t// Specific attribute modification\n\t\t\tnew CheckedAttributeProcessor(prefix),\n\n\t\t\t// Text\n\t\t\tnew TextAttributeProcessor(prefix),\n\t\t\tnew UTextAttributeProcessor(prefix),\n\n\t\t\t// Fragment specification\n\t\t\tnew FragmentAttributeProcessor(prefix)\n\n\t\t\t// Fragment removal\n\t\t);\n\t}\n}\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport StandardDialect from './standard/StandardDialect';\n\n/**\n * Configuration object for the template engine.\n * \n * @typedef {Object} Configuration\n * @property {Array<Dialect>} dialects\n *   A list of dialects to include with this instance of the template engine.\n * @property {Object} [isomorphic]\n *   An object which configures the isomorphic capabilities of the template\n *   engine.\n * @property {Function} templateResolver\n *   A function for returning the text of templates named by fragment\n *   expressions in templates.  Is given only 1 argument, the template name from\n *   a fragment expression, and should return a Promise of the template text.\n */\n\n/**\n * Default configuration for the template engine, configures the standard\n * dialect with no options (uses `thjs` as the prefix).\n * \n * @type {Configuration}\n */\nexport const DEFAULT_CONFIGURATION = {\n\tdialects: [\n\t\tnew StandardDialect()\n\t]\n};\n\n/**\n * Standard configuration, configures the standard dialect with the `th` prefix\n * and enables isomorphic mode which enables the ability to use much of the same\n * processors across original Thymeleaf and ThymeleafJS.\n * \n * @type {Configuration}\n */\nexport const STANDARD_CONFIGURATION = {\n\t...DEFAULT_CONFIGURATION,\n\tdialects: [\n\t\tnew StandardDialect('th')\n\t],\n\tisomorphic: {\n\t\tprefix: 'thjs'\n\t}\n};\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default class Matcher {\n\n\t/**\n\t * Create a matcher to work with the current context and isomorphic processing\n\t * settings.\n\t * \n\t * @param {Object} context\n\t * @param {Object} isomorphic\n\t */\n\tconstructor(context, isomorphic) {\n\n\t\tthis.context    = context;\n\t\tthis.isomorphic = isomorphic;\n\t}\n\n\t/**\n\t * Return the matching attribute of an element that a processor can work over.\n\t * \n\t * @param {Element} element\n\t * @param {AttributeProcessor} processor\n\t * @return {String}\n\t *   The attribute that matched processing by this processor, or `null` if no\n\t *   match was found.\n\t */\n\tmatches(element, processor) {\n\n\t\tlet prefixes = [].concat(\n\t\t\tthis.isomorphic ? this.isomorphic.prefix : [],\n\t\t\tprocessor.prefix\n\t\t);\n\t\tlet {name} = processor;\n\n\t\tfor (let prefix of prefixes) {\n\t\t\tlet attribute;\n\t\t\tattribute = `${prefix}:${name}`;\n\t\t\tif (element.hasAttribute(attribute)) {\n\t\t\t\treturn attribute;\n\t\t\t}\n\t\t\tattribute = `data-${prefix}-${name}`;\n\t\t\tif (element.hasAttribute(attribute)) {\n\t\t\t\treturn attribute;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n}\n","/* \n * Copyright 2018, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Convert a standard node callback-style function into a function that returns\n * a Promise.\n * \n * @param {Function} func\n * @return {Function}\n */\nexport function promisify(func) {\n\treturn function() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tfunc(...arguments, (error, result) => {\n\t\t\t\tif (error) {\n\t\t\t\t\treject(new Error(error));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t};\n}\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DEFAULT_CONFIGURATION}  from './Configurations';\nimport Matcher                  from './processors/Matcher';\nimport StandardDialect          from './standard/StandardDialect';\nimport {promisify}              from './utilities/Functions';\nimport {deserialize, serialize} from './utilities/Dom';\n\nimport {flatten} from '@ultraq/array-utils';\nimport {merge}   from '@ultraq/object-utils';\n\nconst XML_NAMESPACE_ATTRIBUTE = `xmlns:${StandardDialect.DEFAULT_PREFIX}`;\n\n/**\n * A highly-configurable class responsible for processing the Thymeleaf\n * directives found in HTML documents and fragments.\n * \n * @author Emanuel Rabina\n */\nexport default class TemplateEngine {\n\n\t/**\n\t * Constructor, set up a new template engine instance.\n\t * \n\t * @param {Object} config\n\t */\n\tconstructor({dialects, isomorphic, templateResolver} = DEFAULT_CONFIGURATION) {\n\n\t\tthis.dialects         = dialects;\n\t\tthis.isomorphic       = isomorphic;\n\t\tthis.processors       = flatten(dialects.map(dialect => dialect.processors));\n\t\tthis.templateResolver = templateResolver;\n\t}\n\n\t/**\n\t * Process the Thymeleaf template data, returning the processed template.\n\t * \n\t * @param {String} template\n\t * @param {Object} [context={}]\n\t * @return {Promise<String>}\n\t *   A promise resolved with the processed template, or rejected with an error\n\t *   message.\n\t */\n\tprocess(template, context = {}) {\n\n\t\tlet document = deserialize(template);\n\t\tlet rootElement = document.firstElementChild;\n\t\treturn this.processNode(rootElement, {\n\t\t\t...context,\n\t\t\tdialects:         this.dialects,\n\t\t\ttemplateResolver: this.templateResolver\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\t// TODO: Special case, remove the xmlns:th namespace from the document.\n\t\t\t\t//       This should be handled like in main Thymeleaf where it's just\n\t\t\t\t//       another processor that runs on the document.\n\t\t\t\tif (rootElement.hasAttribute(XML_NAMESPACE_ATTRIBUTE)) {\n\t\t\t\t\trootElement.removeAttribute(XML_NAMESPACE_ATTRIBUTE);\n\t\t\t\t}\n\t\t\t\treturn serialize(document);\n\t\t\t});\n\t}\n\n\t/**\n\t * Process the Thymeleaf template at the given path, returning a promise of the\n\t * processed template.\n\t * \n\t * @param {String} filePath\n\t * @param {Object} [context={}]\n\t * @return {Promise<String>}\n\t *   A promise resolved with the processed template, or rejected with an error\n\t *   message.\n\t */\n\tprocessFile(filePath, context = {}) {\n\n\t\t/* global ENVIRONMENT */\n\t\treturn ENVIRONMENT === 'browser' ?\n\t\t\tPromise.reject(new Error('Cannot use fs.readFile inside a browser')) :\n\t\t\tpromisify(require('fs').readFile)(filePath)\n\t\t\t\t.then(data => {\n\t\t\t\t\treturn this.process(data, context);\n\t\t\t\t});\n\t}\n\n\t/**\n\t * Process a DOM element.\n\t * \n\t * @private\n\t * @param {Element} element\n\t * @param {Object} [context={}]\n\t * @return {Promise<Boolean>} Whether or not the parent node needs reprocessing.\n\t */\n\tasync processNode(element, context = {}) {\n\n\t\t// TODO: Standardize this data attribute somewhere.  Shared const?\n\t\t// element.dataset not yet implemented in JSDOM (https://github.com/tmpvar/jsdom/issues/961),\n\t\t// so until then we're getting data- attributes the old-fashioned way.\n\t\t// Alternatively, some kind of variable stack that pops with each move up\n\t\t// the DOM.\n\t\tlet localVariables = JSON.parse(element.getAttribute('data-thymeleaf-local-variables'));\n\t\telement.removeAttribute('data-thymeleaf-local-variables');\n\t\tlet localContext = merge({}, context, localVariables);\n\t\tlet matcher = new Matcher(context, this.isomorphic);\n\n\t\t// Process the current element, store whether or not reprocessing of the\n\t\t// parent needs to happen before moving on to this element's children.\n\t\tlet requireReprocessing = false;\n\t\tfor (let processor of this.processors) {\n\t\t\tlet attribute = matcher.matches(element, processor);\n\t\t\tlet processorResult = attribute ?\n\t\t\t\tawait processor.process(element, attribute, element.getAttribute(attribute), localContext) :\n\t\t\t\tfalse;\n\t\t\trequireReprocessing = requireReprocessing || processorResult;\n\t\t}\n\n\t\tif (requireReprocessing) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Process this element's children\n\t\tlet reprocess;\n\t\tdo {\n\t\t\treprocess = false;\n\t\t\tfor (let child of element.children) {\n\t\t\t\treprocess = await this.processNode(child, localContext);\n\t\t\t\tif (reprocess) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twhile (reprocess);\n\t}\n}\n","/* \n * Copyright 2017, Emanuel Rabina (http://www.ultraq.net.nz/)\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *     http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport {STANDARD_CONFIGURATION}        from './Configurations';\nexport {default as TemplateEngine}     from './TemplateEngine';\nexport {default as Dialect}            from './dialects/Dialect';\nexport {default as AttributeProcessor} from './processors/AttributeProcessor';\nexport {default as StandardDialect}    from './standard/StandardDialect';\n"],"names":["AllInput","ruleName","input","parser","matchResult","parseWithExpression","exhausted","Grammar","name","startingRule","additionalRules","rules","concat","accept","rule","find","Error","Optional","expression","markAndClearOrReset","result","OneOrMore","results","push","length","OrderedChoice","expressions","Sequence","InputBuffer","position","positionStack","lastPosition","pop","undefined","func","mark","clear","reset","pattern","remaining","substring","leadingWhitespace","match","RegExp","source","exec","value","startsWith","newPosition","RegularExpression","matchers","read","parseResults","i","parseResult","defaultMatchProcessor","Rule","matchProcessor","identifier","context","navigate","url","parameters","expressionProcessor","ExpressionProcessor","paramsList","slice","split","map","param","lhs","rhs","process","urlTemplate","head","placeholder","tail","paramEntry","remove","key","join","templateName","fragmentName","localValueName","iterationStatusVariable","collectionExpressionAction","first","rest","coerce","toString","reduce","item","parseFloat","leftOperand","comparator","rightOperand","condition","truthyExpression","falseyExpression","Parser","grammar","inputBuffer","errorMessage","env","NODE_ENV","error","findRuleByName","ThymeleafExpressionLanguage","expressionAction","parse","AttributeProcessor","prefix","AttrAttributeProcessor","NAME","element","attribute","attributeValue","test","forEach","attributeParts","setAttribute","escapeHtml","warn","removeAttribute","CheckedAttributeProcessor","ClassAppendAttributeProcessor","classes","className","EachAttributeProcessor","iterationInfo","iterable","templateNode","cloneNode","localClone","localVariable","JSON","stringify","parentElement","appendChild","removeChild","EmptyableAttributeProcessor","EMPTYABLE_ATTRIBUTE_NAMES","FragmentAttributeProcessor","fragments","clearChildren","firstChild","deserialize","htmlString","ENVIRONMENT","createRange","createContextualFragment","serialize","documentFragment","XMLSerializer","serializeToString","IfAttributeProcessor","expressionResult","parentNode","global","Op","Object","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","inModule","runtime","regeneratorRuntime","module","exports","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","Context","_invoke","makeInvokeMethod","tryCatch","fn","obj","arg","type","call","err","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","constructor","displayName","defineIteratorMethods","method","isGeneratorFunction","genFun","ctor","setPrototypeOf","__proto__","awrap","__await","AsyncIterator","invoke","resolve","reject","record","Promise","then","unwrapped","previousPromise","enqueue","callInvokeWithMethodAndArg","async","iter","next","done","state","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","keys","object","reverse","iteratorMethod","isNaN","skipTempReset","prev","charAt","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","thrown","Function","g","hadRuntime","getOwnPropertyNames","indexOf","oldRuntime","require","e","InsertAttributeProcessor","templateResolver","fragmentInfo","dialects","dialect","StandardDialect","standardDialect","$","dialectPrefix","fragmentProcessorName","template","fragment","log","RemovableAttributeProcessor","REMOVABLE_ATTRIBUTE_NAMES","TextAttributeProcessor","textContent","UTextAttributeProcessor","innerHTML","Dialect","DEFAULT_PREFIX","processors","attributeName","DEFAULT_CONFIGURATION","STANDARD_CONFIGURATION","Matcher","isomorphic","processor","prefixes","hasAttribute","XML_NAMESPACE_ATTRIBUTE","TemplateEngine","flatten","document","rootElement","firstElementChild","processNode","filePath","getAttribute","merge","localVariables","matcher","matches","localContext","requireReprocessing","processorResult","children","child","reprocess"],"mappings":"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"}